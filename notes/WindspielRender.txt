import Float.{ PositiveInfinity => inf }
case class Span( start: Long, stop: Long ) { def length = stop - start }

val x = 
Vector(
Vector(Span(16841, 30645), Span(30645, 61829), Span(61829, 106053), Span(106053, 156453), Span(156453, 197493), Span(197493, 273077), Span(273077, 324277), Span(324277, 357845), Span(357845, 417541), Span(417541, 470661), Span(470661, 523173), Span(523173, 575333), Span(575333, 625717), Span(625717, 731413), Span(731413, 795221), Span(795221, 842789), Span(842789, 889701), Span(889701, 945333), Span(945333, 1060693), Span(1060693, 1185717), Span(1185717, 1224469), Span(1224469, 1294133), Span(1294133, 1345957), Span(1345957, 1401573), Span(1401573, 1454197), Span(1454197, 1505557), Span(1505557, 1558501), Span(1558501, 1612981), Span(1612981, 1663941), Span(1663941, 1742373), Span(1742373, 1794661), Span(1794661, 1844005), Span(1844005, 1895461), Span(1895461, 1947621), Span(1947621, 1999077), Span(1999077, 2056277), Span(2056277, 2112901), Span(2112901, 2199269), Span(2199269, 2267157), Span(2267157, 2319957), Span(2319957, 2369893), Span(2369893, 2421413), Span(2421413, 2472677), Span(2472677, 2526613), Span(2526613, 2580661), Span(2580661, 2636421), Span(2636421, 2690517), Span(2690517, 2744997), Span(2744997, 2796149), Span(2796149, 2846949), Span(2846949, 2913333), Span(2913333, 2964213), Span(2964213, 3013493), Span(3013493, 3065189), Span(3065189, 3117205), Span(3117205, 3174037), Span(3174037, 3228725), Span(3228725, 3281941), Span(3281941, 3333269), Span(3333269, 3388373), Span(3388373, 3442501), Span(3442501, 3493157), Span(3493157, 3600117), Span(3600117, 3666197), Span(3666197, 3724837), Span(3724837, 3778741), Span(3778741, 3833445), Span(3833445, 3886101), Span(3886101, 3939861), Span(3939861, 3988981), Span(3988981, 4040901), Span(4040901, 4096549), Span(4096549, 4153493), Span(4153493, 4210069), Span(4210069, 4260757), Span(4260757, 4312645), Span(4312645, 4365845), Span(4365845, 4417861), Span(4417861, 4471365), Span(4471365, 4524757), Span(4524757, 4574933), Span(4574933, 4597656), Span(4648373, 4698949), Span(4698949, 4752757), Span(4752757, 4807653), Span(4807653, 4865253), Span(4865253, 4915765), Span(4915765, 4969877), Span(4969877, 5025173), Span(5025173, 5076245), Span(5076245, 5126053), Span(5126053, 5178229), Span(5178229, 5228933), Span(5228933, 5284629), Span(5284629, 5346805), Span(5346805, 5404261), Span(5404261, 5458069), Span(5458069, 5513653), Span(5513653, 5569269), Span(5569269, 5628117), Span(5628117, 5681557), Span(5681557, 5739525), Span(5739525, 5797461), Span(5797461, 5852165), Span(5852165, 5902437), Span(5902437, 5953173), Span(5953173, 6004005), Span(6004005, 6054133), Span(6054133, 6101669), Span(6101669, 6150565), Span(6150565, 6200773), Span(6200773, 6249877), Span(6249877, 6302037), Span(6302037, 6355765), Span(6355765, 6407509), Span(6407509, 6458853), Span(6458853, 6511429), Span(6511429, 6567013), Span(6567013, 6616629), Span(6616629, 6669781), Span(6669781, 6722773), Span(6722773, 6772197), Span(6772197, 6824389), Span(6824389, 6876181), Span(6876181, 6932581), Span(6932581, 6984741), Span(6984741, 7039413), Span(7039413, 7093221), Span(7093221, 7147749), Span(7147749, 7199509), Span(7199509, 7250389), Span(7250389, 7302933), Span(7302933, 7353093), Span(7353093, 7404197), Span(7404197, 7456069), Span(7456069, 7507317), Span(7507317, 7564149), Span(7564149, 7619141), Span(7619141, 7676853), Span(7676853, 7730453), Span(7730453, 7783605), Span(7783605, 7835845), Span(7835845, 7885653), Span(7885653, 7941061), Span(7941061, 7992821), Span(7992821, 8044517), Span(8044517, 8097189), Span(8097189, 8149605), Span(8149605, 8201349), Span(8201349, 8254341), Span(8254341, 8304725), Span(8304725, 8355893), Span(8355893, 8408053), Span(8408053, 8458917), Span(8458917, 8509829), Span(8509829, 8564997), Span(8564997, 8619221), Span(8619221, 8669877), Span(8669877, 8722581), Span(8722581, 8773205), Span(8773205, 8831109), Span(8831109, 8885909), Span(8885909, 8939893), Span(8939893, 9041973), Span(9041973, 9105669), Span(9105669, 9158885), Span(9158885, 9208581), Span(9208581, 9259989), Span(9259989, 9310069), Span(9310069, 9361973), Span(9361973, 9414853), Span(9414853, 9468917), Span(9468917, 9519317), Span(9519317, 9569669), Span(9569669, 9622245), Span(9622245, 9676261), Span(9676261, 9724933), Span(9724933, 9779781), Span(9779781, 9833621), Span(9833621, 9890725), Span(9890725, 9945589), Span(9945589, 9997349), Span(9997349, 10056197), Span(10056197, 10107877), Span(10107877, 10160997), Span(10160997, 10210773), Span(10210773, 10261093), Span(10261093, 10321813), Span(10321813, 10369285), Span(10369285, 10424037), Span(10424037, 10471589), Span(10471589, 10528261), Span(10528261, 10576597), Span(10576597, 10628533), Span(10628533, 10683941), Span(10683941, 10733621), Span(10733621, 10788309), Span(10788309, 10835925), Span(10835925, 10937394), Span(10937394, 10990565), Span(10990565, 11045749), Span(11045749, 11096821), Span(11096821, 11146293), Span(11146293, 11196245), Span(11196245, 11248165), Span(11248165, 11297941), Span(11297941, 11350229), Span(11350229, 11443925), Span(11443925, 11491605), Span(11491605, 11542341), Span(11542341, 11597509), Span(11597509, 11649493), Span(11649493, 11703941), Span(11703941, 11757221), Span(11757221, 11804005), Span(11804005, 11901267), Span(11901267, 11946469), Span(11946469, 12016517), Span(12016517, 12068047), Span(12068047, 12128821), Span(12128821, 12166805), Span(12166805, 12273023), Span(12273023, 12307355), Span(12308373, 12360261), Span(12360261, 12412421), Span(12412421, 12464325), Span(12464325, 12512629), Span(12512629, 12559381), Span(12559381, 12610773), Span(12610773, 12659205), Span(12659205, 12710149), Span(12710149, 12763973), Span(12763973, 12814997), Span(12814997, 12867365), Span(12867365, 12963125), Span(12963125, 13031669), Span(13031669, 13091461), Span(13091461, 13147093), Span(13147093, 13204117), Span(13204117, 13255013), Span(13255013, 13304037), Span(13304037, 13356037), Span(13356037, 13401786), Span(13404085, 13450053), Span(13450053, 13524933), Span(13524933, 13572661), Span(13572661, 13617179), Span(13617179, 13660773), Span(13660773, 13705317), Span(13705317, 13752773), Span(13752773, 13800757), Span(13800757, 13848309), Span(13848309, 13933253), Span(13933253, 13988229), Span(13988229, 14035525), Span(14035525, 14132853), Span(14132853, 14179861), Span(14179861, 14229445), Span(14229445, 14299417)), 
Vector(Span(14301413, 14351813), Span(14351813, 14399109), Span(14399109, 14446181), Span(14446181, 14492565), Span(14492565, 14540981), Span(14540981, 14589397), Span(14589397, 14637509), Span(14637509, 14685317), Span(14685317, 14728981), Span(14728981, 14774405), Span(14774405, 14824277), Span(14824277, 14874101), Span(14874101, 14922245), Span(14922245, 14969605), Span(14969605, 15016357), Span(15016357, 15064933), Span(15064933, 15112853), Span(15112853, 15160341), Span(15160341, 15208517), Span(15208517, 15255653), Span(15255653, 15305077), Span(15305077, 15356101), Span(15356101, 15407349), Span(15407349, 15457269), Span(15457269, 15507237), Span(15507237, 15556005), Span(15556005, 15603749), Span(15603749, 15652357), Span(15652357, 15703029), Span(15703029, 15751365), Span(15751365, 15799973), Span(15799973, 15848661), Span(15848661, 15896421), Span(15896421, 15946005), Span(15946005, 15995861), Span(15995861, 16044933), Span(16044933, 16093269), Span(16093269, 16141285), Span(16141285, 16188341), Span(16188341, 16236629), Span(16236629, 16284037), Span(16284037, 16331701), Span(16331701, 16381061), Span(16381061, 16431061), Span(16431061, 16480213), Span(16480213, 16529813), Span(16529813, 16579493), Span(16579493, 16628773), Span(16628773, 16679893), Span(16679893, 16727973), Span(16727973, 16776405), Span(16776405, 16826485), Span(16826485, 16875957), Span(16875957, 16926357), Span(16926357, 16975173), Span(16975173, 17024965), Span(17024965, 17075397), Span(17075397, 17171862), Span(17171862, 17223573), Span(17223573, 17274597), Span(17274597, 17324261), Span(17324261, 17373909), Span(17373909, 17426517), Span(17426517, 17476821), Span(17476821, 17528709), Span(17528709, 17579093), Span(17579093, 17628565), Span(17628565, 17678805), Span(17678805, 17729365), Span(17729365, 17780821), Span(17780821, 17830853), Span(17830853, 17881109), Span(17881109, 17932165), Span(17932165, 17984661), Span(17984661, 18035157), Span(18035157, 18086933), Span(18086933, 18138229), Span(18138229, 18188869), Span(18188869, 18238485), Span(18238485, 18290341), Span(18290341, 18341493), Span(18341493, 18390485), Span(18390485, 18441141), Span(18441141, 18496005), Span(18496005, 18549637), Span(18549637, 18606581), Span(18606581, 18709493), Span(18709493, 18822693), Span(18822693, 18876901), Span(18876901, 18935029), Span(18935029, 18988757), Span(18988757, 19040101), Span(19040101, 19093701), Span(19093701, 19147605), Span(19147605, 19199285), Span(19199285, 19254005), Span(19254005, 19308725), Span(19308725, 19361797), Span(19361797, 19417189), Span(19417189, 19464197), Span(19464197, 19519173), Span(19519173, 19572277), Span(19572277, 19623573), Span(19623573, 19678069), Span(19678069, 19730453), Span(19730453, 19780149), Span(19780149, 19833317), Span(19833317, 19883013), Span(19883013, 19932869), Span(19932869, 19984389), Span(19984389, 20081205), Span(20081205, 20126117), Span(20126117, 20171445), Span(20171445, 20216629), Span(20216629, 20263029), Span(20263029, 20310405), Span(20310405, 20359237), Span(20359237, 20406373), Span(20406373, 20455253), Span(20455253, 20501909), Span(20501909, 20550085), Span(20550085, 20596485), Span(20596485, 20646565), Span(20646565, 20695701), Span(20695701, 20745797), Span(20745797, 20795253), Span(20795253, 20840437), Span(20840437, 20890613), Span(20890613, 20941893), Span(20941893, 20992597), Span(20992597, 21089765), Span(21089765, 21139653), Span(21139653, 21187685), Span(21187685, 21235189), Span(21235189, 21285909), Span(21285909, 21334229), Span(21334229, 21384005), Span(21384005, 21435749), Span(21435749, 21486325), Span(21486325, 21537301), Span(21537301, 21588661), Span(21588661, 21638533), Span(21638533, 21689445), Span(21689445, 21740197), Span(21740197, 21792069), Span(21792069, 21841381), Span(21841381, 21892789), Span(21892789, 21945173), Span(21945173, 21994773), Span(21994773, 22045221), Span(22045221, 22095589), Span(22095589, 22147941), Span(22147941, 22202293), Span(22202293, 22253253), Span(22253253, 22367173), Span(22367173, 22418629), Span(22418629, 22468629), Span(22468629, 22521573), Span(22521573, 22573349), Span(22573349, 22622789), Span(22622789, 22672997), Span(22672997, 22722709), Span(22722709, 22806533), Span(22806533, 22856453), Span(22856453, 22904149), Span(22904149, 22951413), Span(22951413, 23001893), Span(23001893, 23050693), Span(23050693, 23099733), Span(23099733, 23150261), Span(23150261, 23194965), Span(23194965, 23245109), Span(23245109, 23304933), Span(23304933, 23351987), Span(23351987, 23389349), Span(23389349, 23436661), Span(23436661, 23488981), Span(23488981, 23534981), Span(23534981, 23582133), Span(23582133, 23627349), Span(23627349, 23676885), Span(23676885, 23725029), Span(23725029, 23774086), Span(23778629, 23874581), Span(23874581, 23963909), Span(23963909, 24048309), Span(24048309, 24142709), Span(24142709, 24230133), Span(24230133, 24322581), Span(24322581, 24411029), Span(24411029, 24494885), Span(24494885, 24580661), Span(24580661, 24660357), Span(24660357, 24736581), Span(24736581, 24822789), Span(24822789, 24904565), Span(24904565, 24986661), Span(24986661, 25063949)), 
Vector(Span(25066277, 25144037), Span(25144037, 25225445), Span(25225445, 25310629), Span(25310629, 25395813), Span(25395813, 25468661), Span(25468661, 25553493), Span(25553493, 25635637), Span(25635637, 25718917), Span(25718917, 25798469), Span(25798469, 25871653), Span(25871653, 25946901), Span(25946901, 26029989), Span(26029989, 26118213), Span(26118213, 26200197), Span(26200197, 26284901), Span(26284901, 26367957), Span(26367957, 26454357), Span(26454357, 26536821), Span(26536821, 26622965), Span(26622965, 26703653), Span(26703653, 26783461), Span(26783461, 26859781), Span(26859781, 26938917), Span(26938917, 27022629), Span(27022629, 27102421), Span(27102421, 27180613), Span(27180613, 27266981), Span(27266981, 27346437), Span(27346437, 27427653), Span(27427653, 27507333), Span(27507333, 27586773), Span(27586773, 27663125), Span(27663125, 27743269), Span(27743269, 27819845), Span(27819845, 27892677), Span(27892677, 27970821), Span(27970821, 28054005), Span(28054005, 28132629), Span(28132629, 28209093), Span(28209093, 28281509), Span(28281509, 28362501), Span(28362501, 28438501), Span(28438501, 28516325), Span(28516325, 28592869), Span(28592869, 28668933), Span(28668933, 28745397), Span(28745397, 28819557), Span(28819557, 28894469), Span(28894469, 28971669), Span(28971669, 29044005), Span(29044005, 29114661), Span(29114661, 29183669), Span(29183669, 29261253), Span(29261253, 29337701), Span(29337701, 29414773), Span(29414773, 29492357), Span(29492357, 29571589), Span(29571589, 29650645), Span(29650645, 29727061), Span(29727061, 29808821), Span(29808821, 29883445), Span(29883445, 29974408), Span(29974408, 30056853), Span(30056853, 30136245), Span(30136245, 30214309), Span(30214309, 30297045), Span(30297045, 30376261), Span(30376261, 30473221), Span(30473221, 30548645), Span(30548645, 30632293), Span(30632293, 30713893), Span(30713893, 30797509), Span(30797509, 30883173), Span(30883173, 30963029), Span(30963029, 31048229), Span(31048229, 31134821), Span(31134821, 31217045), Span(31217045, 31305778), Span(31305778, 31389910), Span(31389910, 31476597), Span(31476597, 31565550), Span(31565550, 31648382), Span(31648382, 31724405), Span(31724405, 31795509), Span(31795509, 31878661), Span(31878661, 31962213), Span(31962213, 32047701), Span(32047701, 32132997), Span(32132997, 32217781), Span(32217781, 32307493), Span(32307493, 32395877), Span(32395877, 32481157), Span(32481157, 32575589), Span(32575589, 32663269), Span(32663269, 32748677), Span(32748677, 32836197), Span(32836197, 32920229), Span(32920229, 33008805), Span(33008805, 33099446), Span(33099446, 33192997), Span(33192997, 33283061), Span(33283061, 33369701), Span(33369701, 33461093), Span(33461093, 33547621), Span(33547621, 33637125), Span(33637125, 33724453), Span(33724453, 33810677), Span(33810677, 33889957), Span(33889957, 33989349), Span(33989349, 34071317), Span(34071317, 34150229), Span(34150229, 34231861), Span(34231861, 34312853), Span(34312853, 34409733), Span(34409733, 34497813), Span(34497813, 34588533), Span(34588533, 34676165), Span(34676165, 34758501), Span(34758501, 34837285), Span(34837285, 34922805), Span(34922805, 35003173), Span(35003173, 35086069), Span(35086069, 35170677), Span(35170677, 35254533), Span(35254533, 35341493), Span(35341493, 35425029), Span(35425029, 35510341), Span(35510341, 35595413), Span(35595413, 35674165), Span(35674165, 35755301), Span(35755301, 35836117), Span(35836117, 35916757), Span(35916757, 35997173), Span(35997173, 36092453), Span(36092453, 36172453), Span(36172453, 36253237), Span(36253237, 36335397), Span(36335397, 36413765), Span(36413765, 36489013), Span(36489013, 36566213), Span(36566213, 36648453), Span(36648453, 36733509), Span(36733509, 36813045), Span(36813045, 36901829), Span(36901829, 36980885), Span(36980885, 37085861), Span(37085861, 37179781), Span(37179781, 37265445), Span(37265445, 37351237), Span(37351237, 37432661), Span(37432661, 37526037), Span(37526037, 37613685), Span(37613685, 37695877), Span(37695877, 37781045), Span(37781045, 37863813), Span(37863813, 37951701), Span(37951701, 38036437), Span(38036437, 38138821), Span(38138821, 38236629), Span(38236629, 38321205), Span(38321205, 38411125), Span(38411125, 38500495), Span(38500495, 38591205), Span(38591205, 38670069), Span(38670069, 38751301), Span(38751301, 38843349), Span(38843349, 38929973), Span(38929973, 39026229), Span(39026229, 39093829), Span(39093829, 39187125), Span(39187125, 39277349), Span(39277349, 39368949), Span(39368949, 39460052), Span(39460052, 39549813), Span(39549813, 39637237), Span(39637237, 39723077), Span(39723077, 39821677), Span(39821677, 39921477), Span(39921477, 39986837), Span(39986837, 40070885), Span(40070885, 40153557), Span(40153557, 40242053), Span(40242053, 40325765), Span(40325765, 40414261), Span(40414261, 40500357), Span(40500357, 40594101), Span(40594101, 40679461), Span(40679461, 40766613), Span(40766613, 40850533), Span(40850533, 40942469), Span(40942469, 41029493), Span(41029493, 41114293), Span(41114293, 41193077), Span(41193077, 41281567), Span(41281567, 41366901), Span(41366901, 41467093), Span(41467093, 41558373), Span(41558373, 41660149), Span(41660149, 41745381), Span(41745381, 41825395), Span(41826389, 41875525), Span(41875525, 41920565), Span(41920565, 41966853), Span(41966853, 42013381), Span(42013381, 42058946), Span(42058946, 42100453), Span(42100453, 42146693), Span(42146693, 42192101), Span(42192101, 42237621), Span(42237621, 42281925), Span(42281925, 42327365), Span(42327365, 42373669), Span(42373669, 42419685), Span(42419685, 42462965), Span(42462965, 42508789), Span(42508789, 42550741), Span(42550741, 42596661), Span(42596661, 42642165), Span(42642165, 42686005), Span(42686005, 42732869), Span(42732869, 42778725), Span(42778725, 42823925), Span(42823925, 42871045), Span(42871045, 42942067)), 
Vector(Span(42946261, 43029893), Span(43029893, 43132389), Span(43132389, 43222389), Span(43222389, 43312754), Span(43312754, 43399061), Span(43399061, 43489973), Span(43489973, 43580261), Span(43580261, 43652005), Span(43652005, 43738261), Span(43738261, 43825605), Span(43825605, 43916741), Span(43916741, 44007973), Span(44007973, 44097285), Span(44097285, 44183605), Span(44183605, 44271301), Span(44271301, 44359525), Span(44359525, 44447717), Span(44447717, 44538469), Span(44538469, 44623813), Span(44623813, 44711365), Span(44711365, 44800365), Span(44800365, 44888341), Span(44888341, 44977621), Span(44977621, 45065221), Span(45065221, 45156013), Span(45156013, 45249605), Span(45249605, 45338901), Span(45338901, 45431056), Span(45431056, 45520116), Span(45520116, 45611349), Span(45611349, 45699946), Span(45699946, 45795278), Span(45795278, 45884933), Span(45884933, 45988693), Span(45988693, 46063253), Span(46063253, 46152853), Span(46152853, 46239573), Span(46239573, 46329205), Span(46329205, 46415861), Span(46415861, 46506757), Span(46506757, 46597016), Span(46597016, 46688277), Span(46688277, 46773637), Span(46773637, 46866725), Span(46866725, 46950725), Span(46950725, 47058629), Span(47058629, 47145701), Span(47145701, 47242645), Span(47242645, 47328325), Span(47328325, 47412085), Span(47412085, 47501253), Span(47501253, 47595180), Span(47595180, 47680325), Span(47680325, 47772789), Span(47772789, 47863525), Span(47863525, 47953333), Span(47953333, 48045605), Span(48045605, 48140645), Span(48140645, 48229445), Span(48229445, 48323573), Span(48323573, 48408725), Span(48408725, 48498725), Span(48498725, 48584933), Span(48584933, 48671717), Span(48671717, 48757573), Span(48757573, 48844949), Span(48844949, 48932197), Span(48932197, 49019269), Span(49019269, 49098821), Span(49098821, 49188629), Span(49188629, 49279301), Span(49279301, 49370245), Span(49370245, 49455333), Span(49455333, 49549253), Span(49549253, 49635685), Span(49635685, 49731477), Span(49731477, 49816293), Span(49816293, 49905829), Span(49905829, 49989509), Span(49989509, 50072805), Span(50072805, 50162085), Span(50162085, 50248469), Span(50248469, 50334293), Span(50334293, 50427365), Span(50427365, 50513717), Span(50513717, 50605253), Span(50605253, 50695813), Span(50695813, 50789766), Span(50789766, 50877141), Span(50877141, 50970837), Span(50970837, 51062933), Span(51062933, 51155269), Span(51155269, 51246325), Span(51246325, 51337037), Span(51337037, 51429653), Span(51429653, 51518949), Span(51518949, 51610117), Span(51610117, 51699989), Span(51699989, 51789765), Span(51789765, 51876869), Span(51876869, 51965093), Span(51965093, 52051381), Span(52051381, 52135221), Span(52135221, 52222997), Span(52222997, 52309381), Span(52309381, 52402581), Span(52402581, 52490789), Span(52490789, 52583707), Span(52583707, 52672309), Span(52672309, 52760821), Span(52760821, 52841093), Span(52841093, 52923205), Span(52923205, 53004773), Span(53004773, 53085621), Span(53085621, 53172069), Span(53172069, 53256357), Span(53256357, 53338197), Span(53338197, 53429381), Span(53429381, 53523109), Span(53523109, 53616165), Span(53616165, 53706901), Span(53706901, 53794981), Span(53794981, 53887082), Span(53887082, 53979717), Span(53979717, 54070492), Span(54070492, 54158293), Span(54158293, 54244309), Span(54244309, 54339669), Span(54339669, 54428677), Span(54428677, 54522421), Span(54522421, 54604693), Span(54604693, 54698981), Span(54698981, 54785397), Span(54785397, 54870021), Span(54870021, 54955605), Span(54955605, 55039317), Span(55039317, 55131269), Span(55131269, 55218261), Span(55218261, 55299317), Span(55299317, 55394309), Span(55394309, 55481125), Span(55481125, 55565413), Span(55565413, 55651317), Span(55651317, 55741429), Span(55741429, 55822149), Span(55822149, 55909861), Span(55909861, 56012309), Span(56012309, 56113989), Span(56113989, 56205112), Span(56205112, 56309273)), 
Vector(Span(56312517, 56393605), Span(56393605, 56476949), Span(56476949, 56565556), Span(56565556, 56643531), Span(56643531, 56737205), Span(56737205, 56826559), Span(56826559, 56917717), Span(56917717, 57010021), Span(57010021, 57095717), Span(57095717, 57186846), Span(57186846, 57272465), Span(57272465, 57363285), Span(57363285, 57450085), Span(57450085, 57538085), Span(57538085, 57628069), Span(57628069, 57714181), Span(57714181, 57799477), Span(57799477, 57880629), Span(57880629, 57965173), Span(57965173, 58044565), Span(58044565, 58125637), Span(58125637, 58204709), Span(58204709, 58284853), Span(58284853, 58369797), Span(58369797, 58450885), Span(58450885, 58527605), Span(58527605, 58610133), Span(58610133, 58733509), Span(58733509, 58822709), Span(58822709, 58909349), Span(58909349, 58989333), Span(58989333, 59068741), Span(59068741, 59153045), Span(59153045, 59238389), Span(59238389, 59321029), Span(59321029, 59408837), Span(59408837, 59496997), Span(59496997, 59579253), Span(59579253, 59659157), Span(59659157, 59740661), Span(59740661, 59820773), Span(59820773, 59905237), Span(59905237, 59987957), Span(59987957, 60071493), Span(60071493, 60152645), Span(60152645, 60233653), Span(60233653, 60316389), Span(60316389, 60408405), Span(60408405, 60492485), Span(60492485, 60579653), Span(60579653, 60669685), Span(60669685, 60753477), Span(60753477, 60837221), Span(60837221, 60918437), Span(60918437, 61003365), Span(61003365, 61086389), Span(61086389, 61168325), Span(61168325, 61251605), Span(61251605, 61335045), Span(61335045, 61417413), Span(61417413, 61502277), Span(61502277, 61584933), Span(61584933, 61667589), Span(61667589, 61753413), Span(61753413, 61837557), Span(61837557, 61919333), Span(61919333, 61999637), Span(61999637, 62082981), Span(62082981, 62166213), Span(62166213, 62253765), Span(62253765, 62322149), Span(62322149, 62417173), Span(62417173, 62499669), Span(62499669, 62581845), Span(62581845, 62671619), Span(62671619, 62756833), Span(62756833, 62843653), Span(62843653, 62925589), Span(62925589, 63010789), Span(63010789, 63101749), Span(63101749, 63192981), Span(63192981, 63279685), Span(63279685, 63378805), Span(63378805, 63533525), Span(63533525, 63615573), Span(63615573, 63693125), Span(63693125, 63778117), Span(63778117, 63862741), Span(63862741, 63949781), Span(63949781, 64034901), Span(64034901, 64118917), Span(64118917, 64207141), Span(64207141, 64291909), Span(64291909, 64377733), Span(64377733, 64445237), Span(64445237, 64537077), Span(64537077, 64626837), Span(64626837, 64722789), Span(64722789, 64807813), Span(64807813, 64894053), Span(64894053, 64981141), Span(64981141, 65067637), Span(65067637, 65155525), Span(65155525, 65245564), Span(65245564, 65332693), Span(65332693, 65416229), Span(65416229, 65500485), Span(65500485, 65588693), Span(65588693, 65674549), Span(65674549, 65760133), Span(65760133, 65835493), Span(65835493, 65924661), Span(65924661, 66009013), Span(66009013, 66097877), Span(66097877, 66182181), Span(66182181, 66266069), Span(66266069, 66353893), Span(66353893, 66447397), Span(66447397, 66536853), Span(66536853, 66623749), Span(66623749, 66720293), Span(66720293, 66811061), Span(66811061, 66894981), Span(66894981, 66982981), Span(66982981, 67068853), Span(67068853, 67147589), Span(67147589, 67243973), Span(67243973, 67330389), Span(67330389, 67416821), Span(67416821, 67504149), Span(67504149, 67599503), Span(67599503, 67688965), Span(67688965, 67778756), Span(67778756, 67883317), Span(67883317, 67979429), Span(67979429, 68072421), Span(68072421, 68160277), Span(68160277, 68247045), Span(68247045, 68335605), Span(68335605, 68427781), Span(68427781, 68515669), Span(68515669, 68606706), Span(68606706, 68692309), Span(68692309, 68775477), Span(68775477, 68856069), Span(68856069, 68946885), Span(68946885, 69031445), Span(69031445, 69114901), Span(69114901, 69204360), Span(69204360, 69288885), Span(69288885, 69374725), Span(69374725, 69460757), Span(69460757, 69545333), Span(69545333, 69633029), Span(69633029, 69717973), Span(69717973, 69803941), Span(69803941, 69895669), Span(69895669, 69977125), Span(69977125, 70066245), Span(70066245, 70158213), Span(70158213, 70246149), Span(70246149, 70343125), Span(70343125, 70429493), Span(70429493, 70518773), Span(70518773, 70609579), Span(70609579, 70699221), Span(70699221, 70791749), Span(70791749, 70886069), Span(70886069, 70974261), Span(70974261, 71073877), Span(71073877, 71175333), Span(71175333, 71273077), Span(71273077, 71379205), Span(71379205, 71485749), Span(71485749, 71587013), Span(71587013, 71687333), Span(71687333, 71788997), Span(71788997, 71887877), Span(71887877, 71985621), Span(71985621, 72075701), Span(72075701, 72172837), Span(72172837, 72260229), Span(72260229, 72361925), Span(72361925, 72462181), Span(72462181, 72554773), Span(72554773, 72647225), Span(72647225, 72742197), Span(72742197, 72831336), Span(72831336, 72921941), Span(72921941, 73017925), Span(73017925, 73108405), Span(73108405, 73197205), Span(73197205, 73284149), Span(73284149, 73379040), Span(73379040, 73469029), Span(73469029, 73562066), Span(73562066, 73651941), Span(73651941, 73745525), Span(73745525, 73830709), Span(73830709, 73918885), Span(73918885, 74006309), Span(74006309, 74099013), Span(74099013, 74185909), Span(74185909, 74279301), Span(74279301, 74376485), Span(74376485, 74466245), Span(74466245, 74563141), Span(74563141, 74650901), Span(74650901, 74744405), Span(74744405, 74842053), Span(74842053, 74939413), Span(74939413, 75039381), Span(75039381, 75134085), Span(75134085, 75225061), Span(75225061, 75315253), Span(75315253, 75403957), Span(75403957, 75490789), Span(75490789, 75586741), Span(75586741, 75679733), Span(75679733, 75767109), Span(75767109, 75860805), Span(75860805, 75950053), Span(75950053, 76036725), Span(76036725, 76124341), Span(76124341, 76210709), Span(76210709, 76292965), Span(76292965, 76395909), Span(76395909, 76525349), Span(76525349, 76614453), Span(76614453, 76708277), Span(76708277, 76799957), Span(76799957, 76899829), Span(76899829, 76991317), Span(76991317, 77085701), Span(77085701, 77177085), Span(77177085, 77280549), Span(77280549, 77375152), Span(77375152, 77470133), Span(77470133, 77561788), Span(77561788, 77654805), Span(77654805, 77746277), Span(77746277, 77839530), Span(77839530, 77931381), Span(77931381, 78022885), Span(78022885, 78116629), Span(78116629, 78203189), Span(78203189, 78291397), Span(78291397, 78380057), Span(78380057, 78469893), Span(78469893, 78559797), Span(78559797, 78649733), Span(78649733, 78752469), Span(78752469, 78842197), Span(78842197, 78935701), Span(78935701, 79025413), Span(79025413, 79105749), Span(79105749, 79207477), Span(79207477, 79293125), Span(79293125, 79380389), Span(79380389, 79464501), Span(79464501, 79554451), Span(79554451, 79648789), Span(79648789, 79746837), Span(79746837, 79838183), Span(79838183, 79940679)), 
Vector(Span(79946725, 80041777), Span(80041777, 80138085), Span(80138085, 80235861), Span(80235861, 80335845), Span(80335845, 80430453), Span(80430453, 80527717), Span(80527717, 80621493), Span(80621493, 80715221), Span(80715221, 80806853), Span(80806853, 80909669), Span(80909669, 81011397), Span(81011397, 81126005), Span(81126005, 81231957), Span(81231957, 81329221), Span(81329221, 81423156), Span(81423156, 81523237), Span(81523237, 81624293), Span(81624293, 81720613), Span(81720613, 81814837), Span(81814837, 81903477), Span(81903477, 82008757), Span(82008757, 82078245), Span(82078245, 82165781), Span(82165781, 82256773), Span(82256773, 82346293), Span(82346293, 82432165), Span(82432165, 82521029), Span(82521029, 82609923), Span(82609923, 82717733), Span(82717733, 82813781), Span(82813781, 82914901), Span(82914901, 83024917), Span(83024917, 83109141), Span(83109141, 83202981), Span(83202981, 83280581), Span(83280581, 83370293), Span(83370293, 83457989), Span(83457989, 83543397), Span(83543397, 83634325), Span(83634325, 83724275), Span(83724275, 83809781), Span(83809781, 83900021), Span(83900021, 83987557), Span(83987557, 84075685), Span(84075685, 84161061), Span(84161061, 84250949), Span(84250949, 84341077), Span(84341077, 84429925), Span(84429925, 84518021), Span(84518021, 84603861), Span(84603861, 84693829), Span(84693829, 84777221), Span(84777221, 84854149), Span(84854149, 84939093), Span(84939093, 85026133), Span(85026133, 85118373), Span(85118373, 85213637), Span(85213637, 85305684), Span(85305684, 85399653), Span(85399653, 85499845), Span(85499845, 85601317), Span(85601317, 85704965), Span(85704965, 85802021), Span(85802021, 85904021), Span(85904021, 86002917), Span(86002917, 86099845), Span(86099845, 86203541), Span(86203541, 86305285), Span(86305285, 86413429), Span(86413429, 86523285), Span(86523285, 86636725), Span(86636725, 86752949), Span(86752949, 86860789), Span(86860789, 86976741), Span(86976741, 87097893), Span(87097893, 87203173), Span(87203173, 87347685), Span(87347685, 87452389), Span(87452389, 87571797), Span(87571797, 87692549), Span(87692549, 87812037), Span(87812037, 87921477), Span(87921477, 88042821), Span(88042821, 88162149), Span(88162149, 88284981), Span(88284981, 88407013), Span(88407013, 88543701), Span(88543701, 88674373), Span(88674373, 88803317), Span(88803317, 88936581), Span(88936581, 89073493), Span(89073493, 89191317), Span(89191317, 89313109), Span(89313109, 89430341), Span(89430341, 89549365), Span(89549365, 89666613), Span(89666613, 89782485), Span(89782485, 89906901), Span(89906901, 90027301), Span(90027301, 90156501), Span(90156501, 90277797), Span(90277797, 90402053), Span(90402053, 90523525), Span(90523525, 90653781), Span(90653781, 90775077), Span(90775077, 90898021), Span(90898021, 91018581), Span(91018581, 91140165), Span(91140165, 91256075), Span(91256075, 91384533), Span(91384533, 91506501), Span(91506501, 91634469), Span(91634469, 91762869), Span(91762869, 91888277), Span(91888277, 92010149), Span(92010149, 92129365), Span(92129365, 92252213), Span(92252213, 92348718), Span(92348718, 92473797), Span(92473797, 92589653), Span(92589653, 92707637), Span(92707637, 92833637), Span(92833637, 92952805), Span(92952805, 93080645), Span(93080645, 93203365), Span(93203365, 93334405), Span(93334405, 93454693), Span(93454693, 93578341), Span(93578341, 93703301), Span(93703301, 93851461), Span(93851461, 93985845), Span(93985845, 94105685), Span(94105685, 94239333), Span(94239333, 94366917), Span(94366917, 94484421), Span(94484421, 94606325), Span(94606325, 94718517), Span(94718517, 94836261), Span(94836261, 94960277), Span(94960277, 95084501), Span(95084501, 95214613), Span(95214613, 95332629), Span(95332629, 95465413), Span(95465413, 95631141), Span(95631141, 95751493), Span(95751493, 95923378), Span(95923378, 96055557), Span(96055557, 96184933), Span(96184933, 96305797), Span(96305797, 96480597), Span(96480597, 96626309), Span(96626309, 96758725), Span(96758725, 96933813), Span(96933813, 97011765), Span(97011765, 97133925), Span(97133925, 97256741), Span(97256741, 97368261), Span(97368261, 97494773), Span(97494773, 97703973), Span(97703973, 97832437), Span(97832437, 97968581), Span(97968581, 98085509), Span(98085509, 98216213), Span(98216213, 98347829), Span(98347829, 98479429), Span(98479429, 98616341), Span(98616341, 98754709), Span(98754709, 98882613), Span(98882613, 99005269), Span(99005269, 99127973), Span(99127973, 99257285), Span(99257285, 99383813), Span(99383813, 99506517), Span(99506517, 99624773), Span(99624773, 99747013), Span(99747013, 99872453), Span(99872453, 99995205), Span(99995205, 100116805), Span(100116805, 100244085), Span(100244085, 100367365), Span(100367365, 100490501), Span(100490501, 100606645), Span(100606645, 100726565), Span(100726565, 100857605), Span(100857605, 100979589), Span(100979589, 101101269), Span(101101269, 101206069), Span(101206069, 101335861), Span(101335861, 101460277), Span(101460277, 101587525), Span(101587525, 101707861), Span(101707861, 101835749), Span(101835749, 101933909), Span(101933909, 102061253), Span(102061253, 102191125), Span(102191125, 102320005), Span(102320005, 102452261), Span(102452261, 102590693), Span(102590693, 102728213), Span(102728213, 102853669), Span(102853669, 102984981), Span(102984981, 103126357), Span(103126357, 103259317), Span(103259317, 103387477), Span(103387477, 103530917), Span(103530917, 103646837), Span(103646837, 103809893), Span(103809893, 103940357), Span(103940357, 104062453), Span(104062453, 104163813), Span(104163813, 104289605), Span(104289605, 104440677), Span(104440677, 104574869), Span(104574869, 104714011)))

val so = new ServerOptionsBuilder
so.nrtOutputPath = "/Users/hhrutz/Desktop/test.aif"
so.sampleRate = 44100
so.outputBusChannels = 2

val path = "/Users/hhrutz/Documents/Cupola/rec/Windspiel2.aif"

import Util._

val df3 = SynthDef( "WindVoice" ) {
   val bufID     = "buf".ir
   val rate      = "rate".kr( 1 )
   val dur       = "dur".ir
   val play      = VDiskIn.ar( 2, bufID, rate )
   val env       = Line.ar( 1, 0, dur, freeSelf )
//val play = WhiteNoise.ar( 0.2 )
   Out.ar( 0, play * env )
}


val n = 100
val dur = 30.0
val f = 2 * Pi / n
val ph = -Pi / 2
val f2 = 2 * dur / n

// val steps = List.tabulate( n )( i => ((i * f + ph).sin * 0.5 + 0.5).linlin( 0, 1, 0, f2 ))
val minStep = 0.05
val maxStep = 0.5
val pw = 1.5 // 0.125
//val steps0 = List.tabulate( n )( i => ((i * f + ph).sin * 0.5 + 0.5).pow( pw ).linlin( 0, 1, maxStep, minStep ))
//val steps0 = List.tabulate( n )( i => {
//    val j = i * f + ph
//    (-(j.cos) * 0.5 + 0.5 * j)
//})

val off = n.toDouble / -2
val steps0 = List.tabulate( n )( i => (i + off).abs.pow( pw ))

val stepsMin = steps0.min; val stepsMax = steps0.max
val steps = steps0.map( _.linlin( stepsMin, stepsMax, minStep, maxStep ))

//val test = steps.sliding(2,1).map( tup => tup(1) - tup(0) ).toList


val bc = BounceSynthContext( so )
bc.perform( bc.add( df3.recvMsg ))

val xflat = x.flatten
val numHits = xflat.size

var bufID = 0
var nodeID = 1000
val numBufs = n // 30 // XXX should calculate properly
var stopTime = 0.0
val g = new Group( s, 0 )
steps.zipWithIndex foreach { tup =>
    val (dt, step) = tup
    bc.perform {
//        val idx = rand( numHits )
//        val idx = rrand( 0.0, 1.0 ).pow( 4 ).linlin( 0, 1, 0, numHits ).toInt
        val idx = rrand( 0.0, 1.0 ).pow( step.linexp( 0, n - 1, 1.0/4, 4 )).linlin( 0, 1, 0, numHits ).toInt
        val span = xflat( idx )
        val startFrame = span.start.toInt
        val dur = span.length / 44100.0
        val b = new Buffer( s, bufID )
        bufID = (bufID + 1) % numBufs
        bc.add( b.closeMsg( b.freeMsg( release = false )))
        bc.add( b.allocMsg( 32768, 2, b.cueMsg( path, startFrame )))
        val node = new Synth( s, nodeID )
        nodeID += 1
        bc.add( node.newMsg( "WindVoice", g, Seq( "buf" -> bufID, "rate" -> 1.0, "dur" -> dur )))
        stopTime = stopTime.max( bc.timebase + dur )
    }
    bc.timebase += dt
}

bc.timebase = stopTime + 0.1
val worker = bc.render
worker.execute()

bc.dispose
numHits

///////////////

def f( minStep: Double, maxStep: Double, m: Double, num: Int )( n: Int ) = {
   val k = num * 0.5
   ((n - k) / k).abs.pow( m ) * (maxStep - minStep) + minStep
}
    
def calcN2( dur: Double, minStep: Double, maxStep: Double, m: Double, f: Int => Double ) = {
    var num = 1
    var step = 256
    do {
        val test = List.tabulate( num )( f ).sum
        if( test < dur ) {
            if( step < 0 ) step = -step/2
        } else {
            if( step > 0 ) step = -step/2
        }
        num += step
    } while( step.abs > 0 )
    num
}

val g = f( 0.1, 0.5, 1.5, num ) _
calcN2( 30.0, 0.1, 0.5, 1.5, g )


//////////////////

val SPAN_FILE = Dissemination.AUDIO_PATH + "/windspiel_spans"
val raf = new java.io.RandomAccessFile( SPAN_FILE, "rw" )
raf.writeInt( x.size )
x foreach { variants =>
   raf.writeInt( variants.size )
   variants foreach { span =>
      raf.writeLong( span.start )
      raf.writeLong( span.stop )
   }
}
raf.close
